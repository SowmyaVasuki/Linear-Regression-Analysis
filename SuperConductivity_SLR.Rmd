---
title: "SLR_superconductivity"
author: "Sowmya"
date: "17/12/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
sconduct <- read.csv('C:/Users/sowmy/Desktop/Fall2021/Stat-501/Rcode/train.csv')
ncol(sconduct)
names(sconduct)
sconduct_x <-subset (sconduct, select = -critical_temp)
sconduct_y <- sconduct['critical_temp']
names(sconduct_x)
```

## Checking Correlation and removing variables

The Caret package is used to remove any variables, whose correlation is more than the cutoff

```{r}
#install.packages('caret')
library('caret')
df2 = cor(sconduct)
hc = findCorrelation(df2,cutoff=0.5)
hc = sort(hc)
reduced = sconduct[,-c(hc)]
names(reduced)

```
# Plots
Now let us use a scatterplot matrix to see which variables correlates best with the target variable "critical_temp"

```{r}
plot(reduced,col="#69b3a2")
```

## Some Experiments
```{r}
lm1 <- lm(reduced,formula=critical_temp ~.)
summary(lm1)
```
## Leaps Package Experiments
```{r}
install.packages('leaps')
library(leaps)
Best_Subset <-
    regsubsets(area~.,
               data =reduced,
               nbest = 1,      # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")
summary_best_subset <- summary(regsubsets.out)
as.data.frame(summary_best_subset$outmat)
```